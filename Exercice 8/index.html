<!-- À chaque clic sur le bouton, lancer une requête AJAX pour récupérer le lien d'une image de chat sur cette api : https://api.thecatapi.com/v1/images/search?size=full  (l'api donne un lien aléatoire d'une image de chat à chaque fois) et l'afficher à l'écran dans la div de vue. Pendant le chargement, mettre un overlay avec une icone de chargement dedans. -->
<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Révisions Javascript</title>
    <style>
        body{
            text-align: center;
        }
        #view{
            margin: 20px auto;
            width: 1000px;
            height: 800px;
            display: flex;
            align-items: center;
            justify-content: center;
            max-width: 100%;
        }
        #view img{
            max-width: 100%;
            max-height: 100%;
        }
    </style>
</head>
<body>
    <h1>Titre h1 inutile néanmoins présent de la page</h1>
    <button id="start">Click Me !</button>
    <div id="view"></div>

    <script>
        // Code JS à écrire ici

        let overlay = document.createElement('.overlay');
        overlay.id = 'overlay';
        document.querySelector('#start').after(overlay);

        // Fonction permettant d'afficher l'overlay avec icône de chargement
        function setOverlay(){
            document.querySelector('body').append('<div class="overlay"><img src="img/ajax-loader.svg"></div>');
        }
        // Fonction permettant de supprimer l'overlay créé par la fonction setOverlay()
        function removeOverlay(){
            let overlay = document.createElement('#overlay');
            overlay.remove(overlay);
        }
        let view = document.querySelector('#view');
        document.querySelector('#start').addEventListener('click', function(){

            // Mise en place de l'overlay
            setOverlay();

            let xhr = new XMLHttpRequest();

            xhr.open('GET', 'https://api.thecatapi.com/v1/images/search?size=full');
            xhr.send(null);
            xhr.addEventListener('readystatechange', function(){

                if(xhr.readyState === XMLHttpRequest.DONE && xhr.status === 200){
                    let data = JSON.parse(xhr.responseText);
                    let url = data[0].url;
                    let image = document.createElement('img');

                    image.src = url;

                    view.innerHTML = "";
                    view.prepend(image);
                } else {
                    alert('Problème avec le serveur');
                }
            });

            // Suppression de l'overlay
            removeOverlay();

        });


    </script>
</body>
</html>